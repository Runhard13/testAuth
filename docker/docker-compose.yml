networks:
  default:
    name: 'test-auth'

volumes:
  mssql-data:
  mssql-log:
  mssql-secrets:

services:
  mssql:
    container_name: 'test-auth-mssql'
    image: mcr.microsoft.com/mssql/server:2022-latest
    user: root
    environment:
        ACCEPT_EULA: 'Y'
        MSSQL_SA_PASSWORD: 'Pa$$w0rd123qq'
        MSSQL_DATA_DIR: /var/opt/mssql/data
        MSSQL_PID: 'Developer'
        MSSQL_TCP_PORT: 1433
    ports:
        - "1433:1433"
    volumes:
        - mssql-data:/var/opt/mssql/data
        - mssql-log:/var/opt/mssql/log
        - mssql-secrets:/var/opt/mssql/secrets

  api:
    container_name: 'test-auth-api'
    image: 'test-auth-api'
    build:
      context: ../
      dockerfile: src/TestAuth.Api/Dockerfile
    environment:
      ASPNETCORE_ENVIRONMENT: Production
      ASPNETCORE_URLS: http://*:5010
    ports:
      - "5010:5010"

  front:
    container_name: "test-auth-front"
    image: 'test-auth-front'
    build:
      context: ../src/TestAuth.Api/Client
      dockerfile: /Dockerfile
      args:
        - BASE_URL=api:5010
    ports:
      - '3000:3000'
